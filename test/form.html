<!DOCTYPE html>
<html>

<head>
	<script>
	let auto;

	function handlePlace(event) {
		const place = auto.getPlace();
		let addr = "";
		let post = "";
		console.log({
			place
		});
		for(const component of place.address_components) {
			const componentType = component.types[0];
			switch(componentType) {
				case "street_number":
					{
						addr = `${component.long_name} ${addr}`;
						break;
					}
				case "route":
					{
						addr += component.short_name;
						break;
					}
				case "postal_code":
					{
						post = `${component.long_name}${post}`;
						break;
					}
				case "postal_code_suffix":
					{
						post = `${post}-${component.long_name}`;
						break;
					}
				case "locality":
					{
						document.getElementById("city").value = component.long_name;
						break;
					}
				case "administrative_area_level_1":
					{
						document.getElementById("state").value = component.long_name;
						break;
					}
			}
		}
		document.getElementById("addr").value = addr;
		document.getElementById("zip").value = post;
		document.getElementById("addr2").focus();
	}

	function initAutocomplete() {
		const addr = document.getElementById("addr");
		const opts = {
			types: ["address"],
			componentRestrictions: {
				"country": "us"
			},
			fields: ["address_components"]
		};
		auto = new google.maps.places.Autocomplete(addr, opts);
		auto.addListener("place_changed", handlePlace);
	}
	</script>
	<script src="https://maps.googleapis.com/maps/api/js?libraries=places&key=AIzaSyD2VNqpo85RIoDXQoeJbwBUwRjJfkzjOxA&callback=initAutocomplete" async defer></script>
	<style type="text/css">
		.form-frame {
			background-color: transparent;
			text-align: center;
			display: table;
			width: inherit;
			height: inherit;
			margin: 1%;
		}
		.input-field {
			width: 100%;
			box-sizing: border-box;
		}
		.input-stub {
			display: table-cell;
			width: 33.33333333%;
		}
		.input-button {
			width: 50%;
			background-color: transparent;
		}
	</style>
</head>

<body class="form-frame">
	<form id="myForm" method="post">
		<div>
			<label for="name">Preferred name:</label><br>
			<input type="text" id="name" name="full_name" placeholder="First and last name" class="input-field" required="true" autofocus/>
		</div>
		<div>
			<label for="addr">Mailing address:</label><br>
			<input type="text" id="addr" name="address" placeholder="Address" class="input-field" required="true"/><br>
			<input type="text" id="addr2" name="line2" placeholder="Apartment, suite, etc. (optional)" class="input-field"/><br>
			<div class="input-stub">
			<input type="text" id="city" name="city" placeholder="City" class="input-field" required="true"/>
			</div>
			<div class="input-stub">
			<input type="text" id="state" name="state" placeholder="State" class="input-field" required="true"/>
			</div>
			<div class="input-stub">
			<input type="text" id="zip" name="zip" placeholder="ZIP Code" class="input-field" required="true"/>
			</div>
		</div>
		<br>
		<button id="submit" type="submit" class="input-button" formaction="http://localhost:8080">Submit</button>
	</form>
</body>
<script>
function handleSubmit(event) {
	event.preventDefault();
	const data = new FormData(event.target);
	const value = Object.fromEntries(data.entries());
	const param = JSON.stringify(value);
	const raw = {
		"function": "call",
		"parameters": [param]
	};
	const msg = JSON.stringify(raw);
	var url = "https://script.googleapis.com/v1/scripts/AKfycbxFjYr-r1hxmpPnXlgXzGDDcjJ3ctftBkp_A9SF2sFjRnoYV5tzWUEE4zeRoiv2ZzfUeA:run";
}
//document.getElementById("myForm").addEventListener("submit", handleSubmit);
document.getElementById("submit").onclick = function() { this.disabled = true; }
</script>

</html>
